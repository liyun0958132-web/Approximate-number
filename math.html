<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¦‚æ•¸é­”æ³•å¸«ï¼šæƒ…å¢ƒæŒ‘æˆ°ç‰ˆ</title>
    <style>
        :root {
            --floor-color: #0d47a1; --ceil-color: #e65100; --round-color: #7b1fa2; --bg-color: #f4f7f9;
        }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--bg-color); margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }

        /* å…¥å£é¸å–® */
        #menu-screen { text-align: center; background: white; padding: 40px; border-radius: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 850px; }
        .menu-grid { display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 30px; }
        .menu-card { padding: 25px; border-radius: 15px; color: white; cursor: pointer; transition: 0.3s; text-align: left; position: relative; overflow: hidden; }
        .menu-card:hover { transform: translateX(10px); }
        .menu-card h3 { margin: 0; font-size: 1.6rem; }

        /* ä¸»å·¥å…·ä»‹é¢ */
        #tool-screen { display: none; width: 1050px; background: white; padding: 30px; border-radius: 30px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); text-align: center; }
        .comparison-area { display: flex; justify-content: center; align-items: center; gap: 30px; margin-bottom: 20px; }
        .input-group { display: flex; flex-direction: column; align-items: center; }
        input[type="number"], .result-field { font-size: 2.8rem; width: 150px; height: 80px; border-radius: 20px; text-align: center; line-height: 80px; font-weight: bold; border: 5px solid #ddd; }
        #inputNum { border-color: #4a90e2; background: #e3f2fd; }
        .result-field { border-color: #4caf50; background: #e8f5e9; color: #2e7d32; }

        /* æ•¸ç·šå€åŸŸï¼šä¿®æ­£å°–ç«¯ä½ç½® */
        .ruler-viewport { width: 1000px; height: 180px; margin: 20px auto 40px auto; position: relative; }
        #arrow-wrapper { position: absolute; top: 40px; transform: translateX(-50%); transition: left 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); z-index: 10; display: flex; flex-direction: column; align-items: center; }
        #value-bubble { background: #f44336; color: white; padding: 8px 20px; border-radius: 12px; font-size: 2.2rem; font-weight: bold; }
        #arrow-head { width: 0; height: 0; border-left: 12px solid transparent; border-right: 12px solid transparent; border-top: 18px solid #f44336; margin-top: -1px; }
        .ruler-line { position: absolute; top: 115px; width: 1000px; height: 4px; background: #333; }
        .tick { position: absolute; top: 0; width: 2px; background: #ccc; height: 12px; }
        .tick.ten { height: 45px; width: 4px; background: #000; }
        .tick-num { position: absolute; top: 50px; left: 50%; transform: translateX(-50%); font-size: 22px; font-weight: bold; }
        #highlight-segment { position: absolute; top: 115px; height: 8px; border-radius: 4px; transition: 0.6s; opacity: 0; z-index: 1; }

        /* åˆ†æ°´å¶ºæ¨™è¨˜ */
        #mid-line { position: absolute; top: 90px; height: 40px; width: 2px; border-left: 2px dashed #9c27b0; display: none; left: 450px; }

        /* ä¸‰å¤§æŒ‰éˆ• */
        .btn-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0; }
        .btn-logic { padding: 15px; font-size: 1.2rem; font-weight: bold; color: white; border: none; border-radius: 15px; cursor: pointer; box-shadow: 0 5px 0 rgba(0,0,0,0.1); }
        .btn-floor { background: var(--floor-color); }
        .btn-ceil { background: var(--ceil-color); }
        .btn-round { background: var(--round-color); }
        
        /* æç¤ºèˆ‡åé¥‹ */
        #explanation { background: #fffde7; border: 3px dashed #fbc02d; border-radius: 20px; padding: 20px; font-size: 1.4rem; min-height: 60px; }
        #visual-impact { position: absolute; top: -50px; font-size: 3rem; display: none; transition: 0.3s; }
    </style>
</head>
<body>

<div id="menu-screen">
    <h1>ğŸ‘‘ æ¦‚æ•¸é­”æ³•å¸«æŒ‘æˆ°</h1>
    <p>è«‹é¸æ“‡ä¸€å€‹ç”Ÿæ´»ä»»å‹™ï¼š</p>
    <div class="menu-grid">
        <div class="menu-card" style="background: var(--floor-color);" onclick="startChallenge('floor')">
            <h3>ğŸ›’ è¶…å¸‚çµå¸³</h3>
            <p>è€é—†èªªå€‹ä½æ•¸ä¸ç”¨ç®—ï¼Œè¦æº–å‚™å¤šå°‘éŒ¢ï¼Ÿ</p>
        </div>
        <div class="menu-card" style="background: var(--ceil-color);" onclick="startChallenge('ceil')">
            <h3>ğŸšŒ æ ¡å¤–æ•™å­¸</h3>
            <p>ä¸€å°è»Šè¼‰ 10 äººï¼Œæœ‰ 43 äººè¦å»ï¼Œè¦å«å¹¾å°è»Šï¼Ÿ</p>
        </div>
        <div class="menu-card" style="background: var(--round-color);" onclick="startChallenge('round')">
            <h3>ğŸ“ ä¼°è¨ˆé•·åº¦</h3>
            <p>é€™æ ¹ç¹©å­å¤§ç´„æ˜¯å¹¾åå…¬åˆ†ï¼Ÿå“ªé‚Šæ¯”è¼ƒè¿‘ï¼Ÿ</p>
        </div>
    </div>
</div>

<div id="tool-screen">
    <h2 id="quest-title">ä»»å‹™ä¸­...</h2>
    <div class="comparison-area">
        <div class="box"><div class="label">é¡Œç›®æ•¸å­—</div><input type="number" id="inputNum" value="43" oninput="sync()"></div>
        <div style="font-size: 2rem; color: #999;">âœ</div>
        <div class="box"><div class="label">ä½ çš„ç­”æ¡ˆ</div><div id="resultView" class="result-field">?</div></div>
    </div>

    <div class="ruler-viewport">
        <div id="mid-line"></div>
        <div id="arrow-wrapper">
            <div id="visual-impact">ğŸƒğŸ’¨</div>
            <div id="value-bubble">43</div>
            <div id="arrow-head"></div>
        </div>
        <div id="highlight-segment"></div>
        <div class="ruler-line" id="rulerBody"></div>
    </div>

    <p>è«‹é¸æ“‡æ­£ç¢ºçš„æ¦‚æ•¸æ–¹æ³•ï¼š</p>
    <div class="btn-grid">
        <button class="btn-logic btn-floor" onclick="check('floor')">ç„¡æ¢ä»¶æ¨å»æ³•</button>
        <button class="btn-logic btn-ceil" onclick="check('ceil')">ç„¡æ¢ä»¶é€²å…¥æ³•</button>
        <button class="btn-logic btn-round" onclick="check('round')">å››æ¨äº”å…¥æ³•</button>
    </div>

    <div id="explanation">ğŸ’¡ è§€å¯Ÿæƒ…å¢ƒï¼Œé¸éŒ¯äº†é­”æ³•æœƒå¤±æ•—å–”ï¼</div>
    <button style="margin-top:20px;" onclick="location.reload()">â¬… è¿”å›é¸å–®</button>
</div>

<script>
    let correctMethod = '';
    const inputNum = document.getElementById('inputNum');
    const resultView = document.getElementById('resultView');
    const arrowWrapper = document.getElementById('arrow-wrapper');
    const valueBubble = document.getElementById('value-bubble');
    const explanation = document.getElementById('explanation');
    const visualImpact = document.getElementById('visual-impact');

    function startChallenge(mode) {
        correctMethod = mode;
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('tool-screen').style.display = 'block';
        
        const titles = {
            'floor': 'ğŸ›’ ä»»å‹™ï¼šå»è¶…å¸‚è²·æ±è¥¿ï¼Œè€é—†èªªå»é›¶é ­ã€‚',
            'ceil': 'ğŸšŒ ä»»å‹™ï¼šæ ¡å¤–æ•™å­¸è¦å«è»Šï¼Œæ¯å°è¼‰10äººã€‚',
            'round': 'ğŸ“ ä»»å‹™ï¼šé‡é‡çœ‹ï¼Œé€™æ ¹ç¹©å­å¤§ç´„æ˜¯å¤šå°‘ï¼Ÿ'
        };
        document.getElementById('quest-title').innerText = titles[mode];
        document.getElementById('mid-line').style.display = (mode === 'round' ? 'block' : 'none');
        initRuler();
        sync();
    }

    function initRuler() {
        const body = document.getElementById('rulerBody');
        for (let i = 0; i <= 100; i++) {
            const t = document.createElement('div');
            t.style.left = (i * 10) + 'px';
            t.className = (i % 10 === 0) ? 'tick ten' : 'tick';
            if (i % 10 === 0) {
                const n = document.createElement('div');
                n.className = 'tick-num'; n.innerText = i;
                t.appendChild(n);
            }
            body.appendChild(t);
        }
    }

    function sync() {
        let v = parseInt(inputNum.value) || 0;
        arrowWrapper.style.left = (v * 10) + 'px';
        valueBubble.innerText = v;
        resultView.innerText = "?";
        explanation.innerText = "è«‹é¸æ“‡æŒ‰éˆ•...";
        visualImpact.style.display = 'none';
    }

    function check(userMethod) {
        let val = parseInt(inputNum.value) || 0;
        let res = 0;
        let isCorrect = (userMethod === correctMethod);
        
        // è¨ˆç®—çµæœ
        if(userMethod === 'floor') res = Math.floor(val/10)*10;
        else if(userMethod === 'ceil') res = Math.ceil(val/10)*10;
        else res = Math.round(val/10)*10;

        // è¦–è¦ºå›é¥‹
        resultView.innerText = res;
        arrowWrapper.style.left = (res * 10) + 'px';
        
        if (isCorrect) {
            explanation.innerHTML = `âœ… <b>æ­£ç¢ºï¼</b> é€™å°±æ˜¯æœ€å¥½çš„è™•ç†æ–¹å¼ã€‚çµæœæ˜¯ <b>${res}</b>ã€‚`;
            visualImpact.innerText = "ğŸŒŸ";
        } else {
            handleError(userMethod, val, res);
        }
        visualImpact.style.display = 'block';
    }

    function handleError(method, val, res) {
        if (correctMethod === 'ceil' && method === 'floor') {
            explanation.innerHTML = `âŒ <b>ä¸å°å–”ï¼</b> å¦‚æœç”¨æ¨å»æ³•ï¼Œçµæœåªæœ‰ <b>${res}</b>...`;
            visualImpact.innerText = "ğŸ˜° æœ‰ ${val % 10} å€‹äººè¢«ä¸Ÿåœ¨è·¯é‚Šæ²’è»Šæ­ï¼";
        } else if (correctMethod === 'floor' && method === 'ceil') {
            explanation.innerHTML = `âŒ <b>å“å‘€ï¼</b> è€é—†èªªä¸ç”¨ç®—é›¶é ­ï¼Œä½ å»çµ¦äº† <b>${res}</b> å…ƒï¼Œå¤šä»˜éŒ¢å›‰ï¼`;
            visualImpact.innerText = "ğŸ’¸";
        } else if (correctMethod === 'round') {
            let dist = Math.abs(val - res);
            explanation.innerHTML = `âŒ <b>æƒ³ä¸€æƒ³ï¼š</b> è·é›¢ <b>${res}</b> å¥½åƒä¸æ˜¯æœ€è¿‘çš„å–”ï¼`;
            visualImpact.innerText = "ğŸ“?";
        } else {
            explanation.innerHTML = `âŒ <b>é€™å€‹æ–¹æ³•åœ¨ç¾åœ¨çš„æƒ…æ³ä¸‹ä¸å¤ªåˆé©ã€‚</b> å†è©¦ä¸€æ¬¡ï¼`;
            visualImpact.innerText = "â“";
        }
    }
</script>
</body>
</html>